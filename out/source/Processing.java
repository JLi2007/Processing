/* autogenerated by Processing revision 1293 on 2024-10-03 */
import processing.core.*;
import processing.data.*;
import processing.event.*;
import processing.opengl.*;

import java.util.HashMap;
import java.util.ArrayList;
import java.io.File;
import java.io.BufferedReader;
import java.io.PrintWriter;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.IOException;

public class Processing extends PApplet {

Plant[] plants = new Plant[10];
Rabbit charlie = new Rabbit("Charlie", 400, 315, "male", 2, 75, color(160, 100, 100 ), 20);
Rabbit vidul = new Rabbit("Vidul", 100, 420, "female", 3.5f, 35, color(255, 255, 0), 2);

public void setup() {
  /* size commented out by preprocessor */;
  rectMode(CENTER);
  textAlign(CENTER);

  for (int i = 0; i < plants.length; i++) {
    plants[i] = new Plant(random(600),random(600));
  }
}

public void draw() {
  background(0, 255, 50);

  // iterate through plants and draw each plant
  for (Plant plant : plants) {
    plant.drawMe();
  }

  charlie.drawMe();
  vidul.drawMe();

  charlie.move();
  vidul.move();
}
class Plant{
    PVector position;
    float diameter=random(100,150);

    Plant(float x, float y){
        this.position = new PVector(x,y);
    }
    
    public void drawMe(){
        fill(14, 158, 62);
        circle(this.position.x, this.position.y,diameter/2);
    }

    public void removeMe(){
        // I don't know how to remove an instance yet. I wonder how you do that, will probably find out soon
        this.position = new PVector(-600,-600);
    }

    public PVector returnPos(){
        PVector pos = new PVector(this.position.x, this.position.y);
        return pos;
    }
}
float distance;
PVector plant_pos;

class Rabbit {
  //FIELDS (attributes that every rabbit has)
  String name, gender;
  PVector pos, vel;
  float speed, sightRadius, nervousness;
  int furColour;
  
  
  //CONSTRUCTOR (code to build a new Rabbit)
  // new Rabbit("Carl", 100, 315, "male", 6, color(140, 20, 15 ));
  Rabbit(String n, float x, float y, String g, float sp, float sr, int fc, float nv) {
    this.name = n;
    this.pos = new PVector(x, y);
    this.vel = new PVector( random(-2, 2), random(-2, 2) );
    this.speed = sp;
    this.sightRadius = sr;
    this.furColour = fc;
    this.nervousness = nv;
  }
  
  
  //METHODS (things a Rabbit can do)
  public void drawMe() {
    fill( this.furColour );
    square(this.pos.x, this.pos.y, 40);
    
    noFill();
    circle(this.pos.x, this.pos.y, 2*this.sightRadius);
    
    fill(0);
    text(this.name, this.pos.x, this.pos.y);
  }
  
  
  public void move() {
    for (Plant plant : plants) {
      plant_pos=plant.returnPos();
      distance = this.pos.dist(plant_pos);
      
      if(distance < this.sightRadius*2){
        PVector sub = PVector.sub(this.pos, plant_pos);
        sub.normalize();
        this.vel.mult(sub,distance);
        plant.removeMe();
      } 
    }

    if( random(0,100) < this.nervousness ) {  //change the 8 to something more general
      this.pickNewDirection();
    }
    
    this.pos.add( this.vel );

    if(this.pos.x>(600-this.sightRadius) || this.pos.x<(0+this.sightRadius) || this.pos.y>(600-this.sightRadius) || this.pos.y<(0+this.sightRadius)){
      this.vel.mult(random(-1.5f,-1));
    }
  }
  
  
  public void pickNewDirection() {
    float randAngle = random(0, TWO_PI);
    PVector randDir = new PVector( cos(randAngle), sin(randAngle)); //unit vector in the direction we want to go
    this.vel = PVector.mult(randDir, this.speed );
  }
 
}


  public void settings() { size(600, 600); }

  static public void main(String[] passedArgs) {
    String[] appletArgs = new String[] { "Processing" };
    if (passedArgs != null) {
      PApplet.main(concat(appletArgs, passedArgs));
    } else {
      PApplet.main(appletArgs);
    }
  }
}
